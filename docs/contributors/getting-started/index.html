<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/metals/blog/rss.xml" title="Metals Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/metals/blog/atom.xml" title="Metals Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-140140828-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-140140828-1",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Metals" href="/metals/opensearch.xml"><title data-react-helmet="true">Contributing to Metals | Metals</title><meta data-react-helmet="true" property="og:url" content="http://scalameta.org/metals/docs/contributors/getting-started"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Contributing to Metals | Metals"><meta data-react-helmet="true" name="description" content="Whenever you are stuck or unsure, please open an issue or"><meta data-react-helmet="true" property="og:description" content="Whenever you are stuck or unsure, please open an issue or"><meta data-react-helmet="true" property="og:image" content="http://scalameta.org/metals/img/scalameta-logo.png"><meta data-react-helmet="true" name="twitter:image" content="http://scalameta.org/metals/img/scalameta-logo.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/metals/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="http://scalameta.org/metals/docs/contributors/getting-started"><link data-react-helmet="true" rel="alternate" href="http://scalameta.org/metals/docs/contributors/getting-started" hreflang="en"><link data-react-helmet="true" rel="alternate" href="http://scalameta.org/metals/docs/contributors/getting-started" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/metals/assets/css/styles.6fd03f5c.css">
<link rel="preload" href="/metals/assets/js/runtime~main.6863b2b6.js" as="script">
<link rel="preload" href="/metals/assets/js/main.e43c837f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/metals/"><img src="/metals/img/scalameta-logo.png" alt="Metals" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/metals/img/scalameta-logo.png" alt="Metals" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Metals</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/metals/docs/">Docs</a><a class="navbar__item navbar__link" href="/metals/blog/">Blog</a><a href="https://github.com/scalameta/metals" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">üåô</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">‚òÄÔ∏è</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/metals/"><img src="/metals/img/scalameta-logo.png" alt="Metals" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/metals/img/scalameta-logo.png" alt="Metals" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Metals</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/metals/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/metals/blog/">Blog</a></li><li class="menu__list-item"><a href="https://github.com/scalameta/metals" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Text Editors</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/editors/vscode">VS Code</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/editors/vim">Vim</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/editors/sublime">Sublime Text</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/editors/emacs">Emacs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/editors/eclipse">Eclipse</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/editors/online-ides">Online IDEs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/editors/user-configuration">User Configuration</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Build Tools</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/build-tools/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/build-tools/bloop">Bloop</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/build-tools/gradle">Gradle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/build-tools/maven">Maven</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/build-tools/mill">Mill</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/build-tools/sbt">sbt</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Contributing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/metals/docs/contributors/project-goals">Project Goals</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/metals/docs/contributors/getting-started">Contributing to Metals</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/metals/docs/contributors/updating-website">Contributing to the website</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/metals/docs/contributors/releasing">Making a release</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Integrating with Metals</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/integrations/remote-language-server">Remote Language Servers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/integrations/new-build-tool">Integrating a new build tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/integrations/new-editor">Integrating a new editor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/integrations/tree-view-protocol">Tree View Protocol</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/integrations/decoration-protocol">Decoration Protocol</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/integrations/debug-adapter-protocol">Debug Adapter Protocol</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/troubleshooting/proxy">Proxy and mirrors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/metals/docs/troubleshooting/faq">Frequently asked questions</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Contributing to Metals</h1></header><div class="markdown"><p>Whenever you are stuck or unsure, please open an issue or
<a href="https://gitter.im/scalameta/metals" target="_blank" rel="noopener noreferrer">ask on Gitter</a>. This project follows
<a href="https://github.com/scalameta/scalameta/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer">Scalameta&#x27;s contribution guidelines</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="requirements"></a>Requirements<a class="hash-link" href="#requirements" title="Direct link to heading">#</a></h2><p>You will need the following applications installed:</p><ul><li>Java 11 or 8 - Make sure <code>JAVA_HOME</code> points to a Java 11 or 8 installation.
Metals will need to build and run on <em>both</em>.</li><li><code>git</code></li><li><code>sbt</code> (for building a local version of the server)</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="project-structure"></a>Project structure<a class="hash-link" href="#project-structure" title="Direct link to heading">#</a></h2><ul><li><code>metals</code> the main project with sources of the Metals language server.</li><li><code>sbt-metals</code> the sbt plugin used when users are using the BSP support from
sbt to ensure semanticDB is being produced by sbt.</li><li><code>mtags</code> Scala version specific module used to interact with the Scala
presentation compiler. It&#x27;s a dependency of the <code>metals</code> project and can
additionally be used by via <code>mtags-interfaces</code> to support multiple Scala
versions inside the Metals server. It&#x27;s also used by other projects like
<a href="https://github.com/scalameta/metabrowse" target="_blank" rel="noopener noreferrer">Metabrowse</a>.</li><li><code>mtags-interfaces</code> - java interfaces for the presentation compiler.</li><li><code>tests/cross</code> - tests targeting cross builds for common features such as
hover, completions, signatures etc.</li><li><code>tests/input</code> example Scala code that is used as testing data for unit tests.</li><li><code>tests/unit</code> moderately fast-running unit tests.</li><li><code>tests/slow</code> slow integration tests.</li><li><code>test-workspace</code> demo project for manually testing Metals through an editor.</li><li><code>docs</code> documentation markdown for the Metals website.</li><li><code>metals-docs</code> methods used for generating documentation across multiple pages
in <code>docs</code>.</li><li><code>website</code> holds the static site configuraton, style and blogs posts for the
Metals website.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="git-hooks"></a>Git hooks<a class="hash-link" href="#git-hooks" title="Direct link to heading">#</a></h2><p>This git repository has a pre-push hook to run Scalafmt.</p><p>The CI also uses Scalafix to assert that there a no unused imports. To
automatically remove unused imports run <code>sbt scalafixAll</code>. We don&#x27;t run Scalafix
as a pre-push git hook since starting sbt takes a long time.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="related-projects"></a>Related projects<a class="hash-link" href="#related-projects" title="Direct link to heading">#</a></h2><p>The improvement you are looking to contribute may belong in a separate
repository:</p><ul><li><a href="https://github.com/scalameta/metals-vscode/" target="_blank" rel="noopener noreferrer">scalameta/metals-vscode</a>: the
Visual Studio Code extension for Metals.</li><li><a href="https://github.com/scalameta/coc-metals/" target="_blank" rel="noopener noreferrer">scalameta/coc-metals</a>: the
<a href="https://github.com/neoclide/coc.nvim" target="_blank" rel="noopener noreferrer">coc.nvim</a> Vim/Nvim extension for
Metals.</li><li><a href="https://github.com/scalameta/metals-eclipse/" target="_blank" rel="noopener noreferrer">scalameta/metals-eclipse</a>: the
Eclipse extension for Metals.</li><li><a href="https://github.com/scalameta/scalameta/" target="_blank" rel="noopener noreferrer">scalameta/scalameta</a>: SemanticDB,
parsing, tokenization.</li><li><a href="https://github.com/scalameta/munit/" target="_blank" rel="noopener noreferrer">scalameta/munit</a>: Test framework used in
the main Metals repository</li><li><a href="https://github.com/scalacenter/bloop/" target="_blank" rel="noopener noreferrer">scalacenter/bloop</a>: build server for
compilation.</li><li><a href="https://github.com/scala/scala/" target="_blank" rel="noopener noreferrer">scala/scala</a>: presentation compiler.</li><li><a href="https://github.com/scalameta/scalafmt/" target="_blank" rel="noopener noreferrer">scalameta/scalafmt</a>: code formatting.</li><li><a href="https://github.com/scalacenter/scalafix/" target="_blank" rel="noopener noreferrer">scalacenter/scalafix</a>: code
refactoring and linting.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="unit-tests"></a>Unit tests<a class="hash-link" href="#unit-tests" title="Direct link to heading">#</a></h2><p>To run the unit tests open an sbt shell and run <code>unit/test</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sbt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># (recommended) run a specific test suite, great for edit/test/debug workflows.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; unit/testOnly tests.DefinitionSuite</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># run a specific test case inside the suite.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; unit/testOnly tests.DefinitionSuite -- *exact-test-name*</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># run unit tests, moderately fast but still a bit too slow for edit/test/debug workflows.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; unit/test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># run slow integration tests, takes several minutes.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; slow/test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># run presentation compiler tests, these are the quickest tests to run.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; cross/test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># run presentation compiler tests for all Scala versions.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; +cross/test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># (not recommended) run all tests, slow. It&#x27;s better to target individual projects.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; test</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="manually-testing-a-lspsuite"></a>Manually testing a <code>LspSuite</code><a class="hash-link" href="#manually-testing-a-lspsuite" title="Direct link to heading">#</a></h3><p>Every test suite that extends <code>LspSuite</code> generates a workspace directory under
<code>tests/unit/target/e2e/$suitename/$testname</code>. To debug why a <code>LspSuite</code> might be
failing, run the test once and then open it directly in your editor. For
example, for the test case <code>&quot;deprecated-scala&quot;</code> in <code>WarningsLspSuite</code> run the
following command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">code tests/unit/target/e2e/warnings/deprecated-scala</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>If you are using VS Code, make sure to update the &quot;Server Version&quot; setting to
use your locally published version of Metals.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="manual-tests"></a>Manual tests<a class="hash-link" href="#manual-tests" title="Direct link to heading">#</a></h2><p>Some functionality is best to manually test through an editor. A common workflow
while iterating on a new feature is to run <code>publishLocal</code> and then open an
editor in a small demo build.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="visual-studio-code"></a>Visual Studio Code<a class="hash-link" href="#visual-studio-code" title="Direct link to heading">#</a></h3><p>Install the Metals extension from the Marketplace by searching for &quot;Metals&quot;.</p><p><a href="vscode:extension/scalameta.metals" target="_blank" rel="noopener noreferrer">Click here to install the Metals VS Code plugin</a></p><p>Next, update the &quot;Server version&quot; setting under preferences to point to the
version you published locally via <code>sbt publishLocal</code>.</p><p><img src="https://i.imgur.com/ogVWI1t.png" alt="Metals server version setting"></p><p>When you make changes in the Metals Scala codebase</p><ul><li>run <code>sbt publishLocal</code></li><li>execute the &quot;Metals: Restart server&quot; command in Visual Studio Code (via
command palette)</li></ul><p>It&#x27;s important to note that <code>sbt publishLocal</code> will create artifacts only for
the Scala version currently used in Metals and trying to use the snapshot
version with any other Scala version will not work. In that case you need to run
a full cross publish with <code>sbt +publishLocal</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="vim"></a>Vim<a class="hash-link" href="#vim" title="Direct link to heading">#</a></h3><p>First, follow the <a href="/metals/docs/editors/vim"><code>vim</code> installation instruction</a>.</p><p>If you&#x27;re using coc-metals:</p><ul><li>run <code>sbt publishLocal</code></li><li>open <code>:CocConfig</code> and put your new snapshot version in
<code>metals.serverVersion</code>.</li><li>you will then be prompted to reload, which will restart the server.</li></ul><p>If you publish again, you then just need to execute the <code>metals.restartServer
command</code>.</p><p>If you are using another Vim client, write a <code>new-metals-vim</code> script that builds
a new <code>metals-vim</code> bootstrap script using the locally published version.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">coursier bootstrap \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --java-opt -Dmetals.client=vim-lsc \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  org.scalameta:metals_2.12:0.10.8-SNAPSHOT \ # double-check version here</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -r bintray:scalacenter/releases \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -o /usr/local/bin/metals-vim -f</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>NOTE</strong> if you&#x27;re able to configure your client using initialization options,
then the <code>client</code> property is not necessary. You can see all the options
<a href="https://scalameta.org/metals/docs/integrations/new-editor#initializationoptions" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Finally, start Vim with the local Metals version</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd test-workspace # any directory you want to manually test Metals</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">new-metals-vim &amp;&amp; vim build.sbt # remember to have the script in your $PATH</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>When you make changes in the Metals Scala codebase, run <code>sbt publishLocal</code>, quit
vim and re-run <code>new-metals-vim &amp;&amp; vim build.sbt</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="workspace-logs"></a>Workspace logs<a class="hash-link" href="#workspace-logs" title="Direct link to heading">#</a></h3><p>Metals logs workspace-specific information to the
<code>$WORKSPACE/.metals/metals.log</code> file.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">tail -f .metals/metals.log</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>These logs contain information that may be relevant for regular users.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="json-rpc-trace"></a>JSON-RPC trace<a class="hash-link" href="#json-rpc-trace" title="Direct link to heading">#</a></h3><p>To see trace of incoming/outgoing JSON communication with the text editor or
build server, create empty files in your machine cache directory.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># macOS</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">touch -f ~/Library/Caches/org.scalameta.metals/lsp.trace.json # text editor</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">touch -f ~/Library/Caches/org.scalameta.metals/bsp.trace.json # build server</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">touch ~/Library/Caches/org.scalameta.metals/dap-server.trace.json # debug adapter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">touch ~/Library/Caches/org.scalameta.metals/dap-client.trace.json # debug adapter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Linux</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">touch ~/.cache/metals/lsp.trace.json # text editor</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">touch ~/.cache/metals/bsp.trace.json # build server</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">touch ~/.cache/metals/dap-server.trace.json # debug adapter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">touch ~/.cache/metals/dap-client.trace.json # debug adapter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Windows</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">type nul &gt; %LOCALAPPDATA%/scalameta/metals/cache/lsp.trace.json # text editor</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">type nul &gt; %LOCALAPPDATA%/scalameta/metals/cache/bsp.trace.json # build server</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">type nul &gt; %LOCALAPPDATA%/scalameta/metals/cache/dap-server.trace.json # debug adapter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">type nul &gt; %LOCALAPPDATA%/scalameta/metals/cache/dap-client.trace.json # debug adapter</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Next when you start Metals, watch the logs with <code>tail -f</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># macOS</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tail -f ~/Library/Caches/org.scalameta.metals/lsp.trace.json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Linux</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tail -f ~/.cache/metals/lsp.trace.json</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The traces are very verbose so it&#x27;s recommended to delete the files if you are
not interested in debugging the JSON communication.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="jvm-debugging"></a>JVM Debugging<a class="hash-link" href="#jvm-debugging" title="Direct link to heading">#</a></h3><p>To debug the JVM with the Metals server, add a property to your
<code>Server Properties</code> with the usual Java debugging flags, making sure you have
the <code>quiet</code> option on. It&#x27;s important to remember about the flag, as the server
uses standard input/output to communicate with the client, and the default
output of the debuggee interferes with that.</p><p>This property will make your server run in debug mode on port 5005 without
waiting for the debugger to connect:</p><p><code>-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005,quiet=y</code></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="updating-sbt-launcher"></a>Updating sbt-launcher<a class="hash-link" href="#updating-sbt-launcher" title="Direct link to heading">#</a></h3><p>The easiest way to update the sbt-launcher is with the following coursier
command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cp &quot;$(cs fetch org.scala-sbt:sbt-launch:&lt;version&gt;)&quot; sbt-launch.jar</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This will allow you to not have to do some of the manual steps with the launcher
properties file listed <a href="https://github.com/sbt/launcher" target="_blank" rel="noopener noreferrer">here</a>.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/scalameta/metals/edit/main/docs/target/docs/contributors/getting-started.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/metals/docs/contributors/project-goals"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Project Goals</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/metals/docs/contributors/updating-website"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Contributing to the website ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#requirements" class="table-of-contents__link">Requirements</a></li><li><a href="#project-structure" class="table-of-contents__link">Project structure</a></li><li><a href="#git-hooks" class="table-of-contents__link">Git hooks</a></li><li><a href="#related-projects" class="table-of-contents__link">Related projects</a></li><li><a href="#unit-tests" class="table-of-contents__link">Unit tests</a><ul><li><a href="#manually-testing-a-lspsuite" class="table-of-contents__link">Manually testing a <code>LspSuite</code></a></li></ul></li><li><a href="#manual-tests" class="table-of-contents__link">Manual tests</a><ul><li><a href="#visual-studio-code" class="table-of-contents__link">Visual Studio Code</a></li><li><a href="#vim" class="table-of-contents__link">Vim</a></li><li><a href="#workspace-logs" class="table-of-contents__link">Workspace logs</a></li><li><a href="#json-rpc-trace" class="table-of-contents__link">JSON-RPC trace</a></li><li><a href="#jvm-debugging" class="table-of-contents__link">JVM Debugging</a></li><li><a href="#updating-sbt-launcher" class="table-of-contents__link">Updating sbt-launcher</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Overview</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/metals/docs/overview/editor-support">Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/metals/docs/build-tools/overview">Build Tools</a></li><li class="footer__item"><a class="footer__link-item" href="/metals/docs/contributors/project-goals">Project Goals</a></li><li class="footer__item"><a class="footer__link-item" href="/metals/docs/contributors/getting-started">Contributing</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/scalameta/metals" target="_blank">
                      <img src="https://img.shields.io/github/stars/scalameta/metals.svg?color=%23087e8b&label=stars&logo=github&style=social">
                    </a></li><li class="footer__item"><a href="https://discord.gg/RFpSVth" target="_blank">
                      <img src="https://img.shields.io/discord/632642981228314653?logo=discord&style=social">
                    </a></li><li class="footer__item"><a href="https://gitter.im/scalameta/metals" target="_blank">
                      <img src="https://img.shields.io/gitter/room/scalameta/metals.svg?logo=gitter&style=social">
                    </a></li><li class="footer__item"><a href="https://twitter.com/scalameta" target="_blank">
                      <img src="https://img.shields.io/twitter/follow/scalameta.svg?logo=twitter&style=social">
                    </a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/metals/img/scalameta-logo.png" alt="" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/metals/img/scalameta-logo.png" alt="" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></div><div class="footer__copyright">Copyright ¬© 2021 Metals</div></div></div></footer></div>
<script src="/metals/assets/js/runtime~main.6863b2b6.js"></script>
<script src="/metals/assets/js/main.e43c837f.js"></script>
</body>
</html>