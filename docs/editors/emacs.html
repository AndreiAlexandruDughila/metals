<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Emacs · Metals</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Metals works in Emacs thanks to the"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Emacs · Metals"/><meta property="og:type" content="website"/><meta property="og:url" content="http://scalameta.org/metals/index.html"/><meta property="og:description" content="Metals works in Emacs thanks to the"/><meta property="og:image" content="http://scalameta.org/metals/img/scalameta-logo.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="http://scalameta.org/metals/img/scalameta-logo.png"/><link rel="shortcut icon" href="/metals/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css"/><link rel="alternate" type="application/atom+xml" href="http://scalameta.org/metals/blog/atom.xml" title="Metals Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="http://scalameta.org/metals/blog/feed.xml" title="Metals Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-140140828-1', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="/metals/css/custom.css"/><script src="/metals/js/scrollSpy.js"></script><link rel="stylesheet" href="/metals/css/main.css"/><script src="/metals/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/metals/"><img class="logo" src="/metals/img/scalameta-logo.png" alt="Metals"/><h2 class="headerTitleWithLogo">Metals</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/metals/docs/editors/overview.html" target="_self">Docs</a></li><li class=""><a href="/metals/blog/" target="_self">Blog</a></li><li class=""><a href="https://github.com/scalameta/metals" target="_blank">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Text Editors</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Text Editors</h3><ul class=""><li class="navListItem"><a class="navItem" href="/metals/docs/editors/overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/editors/vscode.html">Visual Studio Code</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/editors/vim.html">Vim</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/editors/sublime.html">Sublime Text</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/metals/docs/editors/emacs.html">Emacs</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/editors/eclipse.html">Eclipse</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Build Tools</h3><ul class=""><li class="navListItem"><a class="navItem" href="/metals/docs/build-tools/overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/build-tools/bloop.html">Bloop</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/build-tools/gradle.html">Gradle</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/build-tools/maven.html">Maven</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/build-tools/mill.html">Mill</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/build-tools/sbt.html">sbt</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Contributing</h3><ul class=""><li class="navListItem"><a class="navItem" href="/metals/docs/contributors/project-goals.html">Project Goals</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/contributors/getting-started.html">Contributing to Metals</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/contributors/updating-website.html">Contributing to the website</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/contributors/releasing.html">Making a release</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/contributors/tests.html">Tests overview</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Integrating with Metals</h3><ul class=""><li class="navListItem"><a class="navItem" href="/metals/docs/integrations/remote-language-server.html">Remote Language Servers</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/integrations/new-build-tool.html">Integrating a new build tool</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/integrations/new-editor.html">Integrating a new editor</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/integrations/tree-view-protocol.html">Tree View Protocol</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/integrations/decoration-protocol.html">Decoration Protocol</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/integrations/debug-adapter-protocol.html">Debug Adapter Protocol</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Troubleshooting</h3><ul class=""><li class="navListItem"><a class="navItem" href="/metals/docs/troubleshooting/proxy.html">Proxy and mirrors</a></li><li class="navListItem"><a class="navItem" href="/metals/docs/troubleshooting/faq.html">Frequently asked questions</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/scalameta/metals/edit/main/docs/editors/emacs.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Emacs</h1></header><article><div><span><p>Metals works in Emacs thanks to the
<a href="https://github.com/emacs-lsp/lsp-mode"><code>lsp-mode</code></a> package.</p>
<p><img src="https://i.imgur.com/KJQLMZ7.gif" alt="Emacs demo"></p>
<h2><a class="anchor" aria-hidden="true" id="requirements"></a><a href="#requirements" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Requirements</h2>
<p><strong>Java 8 or 11 provided by OpenJDK or Oracle</strong>. Eclipse OpenJ9 is not
supported, please make sure the <code>JAVA_HOME</code> environment variable
points to a valid Java 8 or 11 installation.</p>
<p><strong>macOS, Linux or Windows</strong>. Metals is developed on macOS and every PR is
tested on Ubuntu+Windows.</p>
<p><strong>Scala 2.13, 2.12, 2.11 and Scala 3</strong>. Metals supports these Scala versions 2.13.4, 2.12.13, 2.12.12, 2.12.11, 2.12.10, 2.13.2, 2.13.3, 2.11.12, 2.12.8, 2.12.9, 2.13.0, 2.13.1, 3.0.0-M3, 3.0.0-M2 and 3.0.0-M1.
Note that 2.11.x support is deprecated and it will be removed in future releases.
It's recommended to upgrade to Scala 2.12 or Scala 2.13</p>
<h2><a class="anchor" aria-hidden="true" id="installation"></a><a href="#installation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h2>
<p>To use Metals in Emacs, place this snippet in your Emacs configuration (for example .emacs.d/init.el) to load
<code>lsp-mode</code> along with its dependencies:</p>
<pre><code class="hljs css language-el">(<span class="hljs-name">require</span> 'package)

<span class="hljs-comment">;; Add melpa to your packages repositories</span>
(<span class="hljs-name">add-to-list</span> 'package-archives '(<span class="hljs-string">"melpa"</span> . <span class="hljs-string">"https://melpa.org/packages/"</span>) <span class="hljs-literal">t</span>)

(<span class="hljs-name">package-initialize</span>)

<span class="hljs-comment">;; Install use-package if not already installed</span>
(<span class="hljs-name">unless</span> (<span class="hljs-name">package-installed-p</span> 'use-package)
  (<span class="hljs-name">package-refresh-contents</span>)
  (<span class="hljs-name">package-install</span> 'use-package))

(<span class="hljs-name">require</span> 'use-package)

<span class="hljs-comment">;; Enable defer and ensure by default for use-package</span>
<span class="hljs-comment">;; Keep auto-save/backup files separate from source code:  https://github.com/scalameta/metals/issues/1027</span>
(<span class="hljs-name">setq</span> use-package-always-defer <span class="hljs-literal">t</span>
      use-package-always-ensure <span class="hljs-literal">t</span>
      backup-directory-alist `((<span class="hljs-string">".*"</span> . ,temporary-file-directory))
      auto-save-file-name-transforms `((<span class="hljs-string">".*"</span> ,temporary-file-directory <span class="hljs-literal">t</span>)))

<span class="hljs-comment">;; Enable scala-mode for highlighting, indentation and motion commands</span>
(<span class="hljs-name">use-package</span> scala-mode
  <span class="hljs-symbol">:interpreter</span>
    (<span class="hljs-string">"scala"</span> . scala-mode))

<span class="hljs-comment">;; Enable sbt mode for executing sbt commands</span>
(<span class="hljs-name">use-package</span> sbt-mode
  <span class="hljs-symbol">:commands</span> sbt-start sbt-command
  <span class="hljs-symbol">:config</span>
  <span class="hljs-comment">;; WORKAROUND: https://github.com/ensime/emacs-sbt-mode/issues/31</span>
  <span class="hljs-comment">;; allows using SPACE when in the minibuffer</span>
  (<span class="hljs-name">substitute-key-definition</span>
   'minibuffer-complete-word
   'self-insert-command
   minibuffer-local-completion-map)
   <span class="hljs-comment">;; sbt-supershell kills sbt-mode:  https://github.com/hvesalai/emacs-sbt-mode/issues/152</span>
   (<span class="hljs-name">setq</span> sbt<span class="hljs-symbol">:program-options</span> '(<span class="hljs-string">"-Dsbt.supershell=false"</span>))
)

<span class="hljs-comment">;; Enable nice rendering of diagnostics like compile errors.</span>
(<span class="hljs-name">use-package</span> flycheck
  <span class="hljs-symbol">:init</span> (<span class="hljs-name">global-flycheck-mode</span>))

(<span class="hljs-name">use-package</span> lsp-mode
  <span class="hljs-comment">;; Optional - enable lsp-mode automatically in scala files</span>
  <span class="hljs-symbol">:hook</span>  (<span class="hljs-name">scala-mode</span> . lsp)
         (<span class="hljs-name">lsp-mode</span> . lsp-lens-mode)
  <span class="hljs-symbol">:config</span> (<span class="hljs-name">setq</span> lsp-prefer-flymake <span class="hljs-literal">nil</span>))

<span class="hljs-comment">;; Add metals backend for lsp-mode</span>
(<span class="hljs-name">use-package</span> lsp-metals
  <span class="hljs-symbol">:config</span> (<span class="hljs-name">setq</span> lsp-metals-treeview-show-when-views-received <span class="hljs-literal">t</span>))

<span class="hljs-comment">;; Enable nice rendering of documentation on hover</span>
(<span class="hljs-name">use-package</span> lsp-ui)

<span class="hljs-comment">;; lsp-mode supports snippets, but in order for them to work you need to use yasnippet</span>
<span class="hljs-comment">;; If you don't want to use snippets set lsp-enable-snippet to nil in your lsp-mode settings</span>
<span class="hljs-comment">;;   to avoid odd behavior with snippets and indentation</span>
(<span class="hljs-name">use-package</span> yasnippet)

<span class="hljs-comment">;; Add company-lsp backend for metals</span>
(<span class="hljs-name">use-package</span> company-lsp)

<span class="hljs-comment">;; Use the Debug Adapter Protocol for running tests and debugging</span>
(<span class="hljs-name">use-package</span> posframe
  <span class="hljs-comment">;; Posframe is a pop-up tool that must be manually installed for dap-mode</span>
  )
(<span class="hljs-name">use-package</span> dap-mode
  <span class="hljs-symbol">:hook</span>
  (<span class="hljs-name">lsp-mode</span> . dap-mode)
  (<span class="hljs-name">lsp-mode</span> . dap-ui-mode)
  )
</code></pre>
<blockquote>
<p>You may need to disable other packages like <code>ensime</code> or sbt server to prevent
conflicts with Metals.</p>
</blockquote>
<p>If you start Emacs now then it will fail since the <code>metals-emacs</code> binary does
not exist yet.</p>
<p>Next, build a <code>metals-emacs</code> binary for the latest Metals release using the
<a href="https://github.com/coursier/coursier">Coursier</a> command-line interface.</p>
<table>
      <thead>
        <th>Version</th>
        <th>Published</th>
        <th>Resolver</th>
      </thead>
      <tbody>
        <tr>
          <td>0.9.10</td>
          <td>19 Jan 2021 17:26</td>
          <td><code>-r sonatype:releases</code></td>
        </tr>
        <tr>
          <td>0.9.10+64-d75735d5-SNAPSHOT</td>
          <td>01 Feb 2021 07:27</td>
          <td><code>-r sonatype:snapshots</code></td>
        </tr>
      </tbody>
    </table>
<pre><code class="hljs css language-sh"><span class="hljs-comment"># Make sure to use coursier v1.1.0-M9 or newer.</span>
curl -L -o coursier https://git.io/coursier-cli
chmod +x coursier
./coursier bootstrap \
  --java-opt -Xss4m \
  --java-opt -Xms100m \
  --java-opt -Dmetals.client=emacs \
  org.scalameta:metals_2.12:0.9.10 \
  -r bintray:scalacenter/releases \
  -r sonatype:snapshots \
  -o /usr/<span class="hljs-built_in">local</span>/bin/metals-emacs -f
</code></pre>
<p>Make sure the generated <code>metals-emacs</code> binary is available on your <code>$PATH</code>.</p>
<p>You can check version of your binary by executing <code>metals-emacs -version</code>.</p>
<p>Configure the system properties <code>-Dhttps.proxyHost=… -Dhttps.proxyPort=…</code>
if you are behind an HTTP proxy.</p>
<p>The <code>-Dmetals.client=emacs</code> flag is important since it configures Metals for
usage with Emacs.</p>
<h2><a class="anchor" aria-hidden="true" id="importing-a-build"></a><a href="#importing-a-build" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Importing a build</h2>
<p>The first time you open Metals in a new workspace it prompts you to import the build.
Type &quot;Import build&quot; or press <code>Tab</code> and select &quot;Import build&quot; to start the installation step.</p>
<p><img src="https://i.imgur.com/UdwMQFk.png" alt="Import build"></p>
<ul>
<li>&quot;Not now&quot; disables this prompt for 2 minutes.</li>
<li>&quot;Don't show again&quot; disables this prompt forever, use <code>rm -rf .metals/</code> to re-enable
the prompt.</li>
<li>Use <code>tail -f .metals/metals.log</code> to watch the build import progress.</li>
<li>Behind the scenes, Metals uses <a href="https://scalacenter.github.io/bloop/">Bloop</a> to
import sbt builds, but you don't need Bloop installed on your machine to run this step.</li>
</ul>
<p>Once the import step completes, compilation starts for your open <code>*.scala</code>
files.</p>
<p>Once the sources have compiled successfully, you can navigate the codebase with
goto definition.</p>
<h3><a class="anchor" aria-hidden="true" id="custom-sbt-launcher"></a><a href="#custom-sbt-launcher" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Custom sbt launcher</h3>
<p>By default, Metals runs an embedded <code>sbt-launch.jar</code> launcher that respects <code>.sbtopts</code> and <code>.jvmopts</code>.
However, the environment variables <code>SBT_OPTS</code> and <code>JAVA_OPTS</code> are not respected.</p>
<p>Update the server property <code>-Dmetals.sbt-script=/path/to/sbt</code> to use a custom
<code>sbt</code> script instead of the default Metals launcher if you need further
customizations like reading environment variables.</p>
<h3><a class="anchor" aria-hidden="true" id="speeding-up-import"></a><a href="#speeding-up-import" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Speeding up import</h3>
<p>The &quot;Import build&quot; step can take a long time, especially the first time you
run it in a new build. The exact time depends on the complexity of the build and
if library dependencies need to be downloaded. For example, this step can take
everything from 10 seconds in small cached builds up to 10-15 minutes in large
uncached builds.</p>
<p>Consult the <a href="https://scalacenter.github.io/bloop/docs/build-tools/sbt#speeding-up-build-export">Bloop documentation</a>
to learn how to speed up build import.</p>
<h3><a class="anchor" aria-hidden="true" id="importing-changes"></a><a href="#importing-changes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Importing changes</h3>
<p>When you change <code>build.sbt</code> or sources under <code>project/</code>, you will be prompted to
re-import the build.</p>
<p><img src="https://i.imgur.com/UFK0p8i.png" alt="Import sbt changes"></p>
<h2><a class="anchor" aria-hidden="true" id="manually-trigger-build-import"></a><a href="#manually-trigger-build-import" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Manually trigger build import</h2>
<p>To manually trigger a build import, run <code>M-x lsp-metals-build-import</code>.</p>
<p><img src="https://i.imgur.com/SvGXJDK.png" alt="Import build command"></p>
<h2><a class="anchor" aria-hidden="true" id="run-doctor"></a><a href="#run-doctor" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Run doctor</h2>
<p>Run <code>M-x lsp-metals-doctor-run</code> to troubleshoot potential configuration problems
in your build.</p>
<p><img src="https://i.imgur.com/yelm0jd.png" alt="Run doctor command"></p>
<h3><a class="anchor" aria-hidden="true" id="eglot"></a><a href="#eglot" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>eglot</h3>
<p>There is an alternative LSP client called
<a href="https://github.com/joaotavora/eglot">eglot</a> that might be worth trying out if
you want to use an alternative to lsp-mode.</p>
<p>To configure Eglot with Metals:</p>
<pre><code class="hljs css language-el">(<span class="hljs-name">require</span> 'package)

<span class="hljs-comment">;; Add melpa-stable to your packages repositories</span>
(<span class="hljs-name">add-to-list</span> 'package-archives '(<span class="hljs-string">"melpa-stable"</span> . <span class="hljs-string">"https://stable.melpa.org/packages/"</span>) <span class="hljs-literal">t</span>)

(<span class="hljs-name">package-initialize</span>)

<span class="hljs-comment">;; Install use-package if not already installed</span>
(<span class="hljs-name">unless</span> (<span class="hljs-name">package-installed-p</span> 'use-package)
  (<span class="hljs-name">package-refresh-contents</span>)
  (<span class="hljs-name">package-install</span> 'use-package))

(<span class="hljs-name">require</span> 'use-package)

<span class="hljs-comment">;; Enable defer and ensure by default for use-package</span>
(<span class="hljs-name">setq</span> use-package-always-defer <span class="hljs-literal">t</span>
      use-package-always-ensure <span class="hljs-literal">t</span>)

<span class="hljs-comment">;; Enable scala-mode and sbt-mode</span>
(<span class="hljs-name">use-package</span> scala-mode
  <span class="hljs-symbol">:interpreter</span>
    (<span class="hljs-string">"scala"</span> . scala-mode))

<span class="hljs-comment">;; Enable sbt mode for executing sbt commands</span>
(<span class="hljs-name">use-package</span> sbt-mode
  <span class="hljs-symbol">:commands</span> sbt-start sbt-command
  <span class="hljs-symbol">:config</span>
  <span class="hljs-comment">;; WORKAROUND: https://github.com/ensime/emacs-sbt-mode/issues/31</span>
  <span class="hljs-comment">;; allows using SPACE when in the minibuffer</span>
  (<span class="hljs-name">substitute-key-definition</span>
   'minibuffer-complete-word
   'self-insert-command
   minibuffer-local-completion-map)
   <span class="hljs-comment">;; sbt-supershell kills sbt-mode:  https://github.com/hvesalai/emacs-sbt-mode/issues/152</span>
   (<span class="hljs-name">setq</span> sbt<span class="hljs-symbol">:program-options</span> '(<span class="hljs-string">"-Dsbt.supershell=false"</span>))
)

(<span class="hljs-name">use-package</span> eglot
  <span class="hljs-symbol">:pin</span> melpa-stable
  <span class="hljs-symbol">:config</span>
  (<span class="hljs-name">add-to-list</span> 'eglot-server-programs '(scala-mode . (<span class="hljs-string">"metals-emacs"</span>)))
  <span class="hljs-comment">;; (optional) Automatically start metals for Scala files.</span>
  <span class="hljs-symbol">:hook</span> (<span class="hljs-name">scala-mode</span> . eglot-ensure))
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="files-and-directories-to-include-in-your-gitignore"></a><a href="#files-and-directories-to-include-in-your-gitignore" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Files and Directories to include in your Gitignore</h2>
<p>The Metals server places logs and other files in the <code>.metals</code> directory. The
Bloop compile server places logs and compilation artifacts in the <code>.bloop</code>
directory. The Bloop plugin that generates Bloop configuration is added in the
<code>metals.sbt</code> file, which is added at <code>project/metals.sbt</code> as well as further
<code>project</code> directories depending on how deep <code>*.sbt</code> files need to be supported.
To support each <code>*.sbt</code> file Metals needs to create an additional file at
<code>./project/project/metals.sbt</code> relative to the sbt file.
Working with Ammonite scripts will place compiled scripts into the <code>.ammonite</code> directory.
It's recommended to exclude these directories and files
from version control systems like git.</p>
<pre><code class="hljs css language-sh"><span class="hljs-comment"># ~/.gitignore</span>
.metals/
.bloop/
.ammonite/
metals.sbt
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="worksheets"></a><a href="#worksheets" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Worksheets</h2>
<p>Worksheets are a great way to explore an api, try out an idea, or code
up an example and quickly see the evaluated expression or result. Behind
the scenes worksheets are powered by the great work done in
<a href="https://scalameta.org/mdoc/">mdoc</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="getting-started-with-worksheets"></a><a href="#getting-started-with-worksheets" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Getting started with Worksheets</h3>
<p>To get started with a worksheet you can either use the <code>metals.new-scala-file</code>
command and select <em>Worksheet</em> or create a file called <code>*.worksheet.sc</code>.
This format is important since this is what tells Metals that it's meant to be
treated as a worksheet and not just a Scala script. Where you create the
script also matters. If you'd like to use classes and values from your
project, you need to make sure the worksheet is created inside of your <code>src</code>
directory. You can still create a worksheet in other places, but you will
only have access to the standard library and your dependencies.</p>
<h3><a class="anchor" aria-hidden="true" id="evaluations"></a><a href="#evaluations" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Evaluations</h3>
<p>After saving you'll see the result of the expression as a comment as the end of the line.
You may not see the full result for example if it's too long, so you are also
able to hover on the comment to expand.</p>
<p>Keep in mind that you don't need to wrap your code in an <code>object</code>. In worksheets
everything can be evaluated at the top level.</p>
<h3><a class="anchor" aria-hidden="true" id="using-dependencies-in-worksheets"></a><a href="#using-dependencies-in-worksheets" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using dependencies in worksheets</h3>
<p>You are able to include an external dependency in your worksheet by including
it in one of the following two ways.</p>
<pre><code class="hljs css language-scala"><span class="hljs-comment">// $dep.`organisation`::artifact:version` style</span>
<span class="hljs-keyword">import</span> $dep.`com.lihaoyi::scalatags:<span class="hljs-number">0.7</span><span class="hljs-number">.0</span>`

<span class="hljs-comment">// $ivy.`organisation::artifact:version` style</span>
<span class="hljs-keyword">import</span> $ivy.`com.lihaoyi::scalatags:<span class="hljs-number">0.7</span><span class="hljs-number">.0</span>`
</code></pre>
<p>:: is the same as %% in sbt, which will append the current Scala binary version
to the artifact name.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/metals/docs/editors/sublime.html"><span class="arrow-prev">← </span><span>Sublime Text</span></a><a class="docs-next button" href="/metals/docs/editors/eclipse.html"><span>Eclipse</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#requirements">Requirements</a></li><li><a href="#installation">Installation</a></li><li><a href="#importing-a-build">Importing a build</a><ul class="toc-headings"><li><a href="#custom-sbt-launcher">Custom sbt launcher</a></li><li><a href="#speeding-up-import">Speeding up import</a></li><li><a href="#importing-changes">Importing changes</a></li></ul></li><li><a href="#manually-trigger-build-import">Manually trigger build import</a></li><li><a href="#run-doctor">Run doctor</a><ul class="toc-headings"><li><a href="#eglot">eglot</a></li></ul></li><li><a href="#files-and-directories-to-include-in-your-gitignore">Files and Directories to include in your Gitignore</a></li><li><a href="#worksheets">Worksheets</a><ul class="toc-headings"><li><a href="#getting-started-with-worksheets">Getting started with Worksheets</a></li><li><a href="#evaluations">Evaluations</a></li><li><a href="#using-dependencies-in-worksheets">Using dependencies in worksheets</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer" style="background-color:#1B555C"><section class="sitemap"><a href="/metals/" class="nav-home"><img src="/metals/img/scalameta-logo.png" alt="Metals" width="66" height="58"/></a><div><h5>Overview</h5><a href="/metals/docs/editors/overview.html">Text Editors</a><a href="/metals/docs/build-tools/overview.html">Build Tools</a><a href="/metals/docs/contributors/project-goals.html">Project Goals</a><a href=" /metals/docs/contributors/getting-started.html">Contributing</a></div><div><h5>Editors</h5><a href="/metals/docs/editors/vscode.html">Visual Studio Code</a><a href="/metals/docs/editors/vim.html">Vim</a><a href="/metals/docs/editors/sublime.html">Sublime Text</a><a href="/metals/docs/editors/emacs.html">Emacs</a><a href="/metals/docs/editors/eclipse.html">Eclipse</a></div><div><h5>Social</h5><a href="https://github.com/scalameta/metals" target="_blank"><img src="https://img.shields.io/github/stars/scalameta/metals.svg?color=%23087e8b&amp;label=stars&amp;logo=github&amp;style=social"/></a><a href="https://discord.gg/RFpSVth" target="_blank"><img src="https://img.shields.io/discord/632642981228314653?logo=discord&amp;style=social"/></a><a href="https://gitter.im/scalameta/metals" target="_blank"><img src="https://img.shields.io/gitter/room/scalameta/metals.svg?logo=gitter&amp;style=social"/></a><a href="https://twitter.com/scalameta" target="_blank"><img src="https://img.shields.io/twitter/follow/scalameta.svg?logo=twitter&amp;style=social"/></a></div></section><section class="copyright">Copyright © 2021 Metals</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'c865f6d974a3072a35d4b53d48ac2307',
                indexName: 'metals',
                inputSelector: '#search_input_react'
              });
            </script></body></html>